(()=>{"use strict";({136:function(){var e=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(a,o){function l(e){try{d(i.next(e))}catch(e){o(e)}}function s(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}d((i=i.apply(e,t||[])).next())}))};const t="https://api.github.com/repos/asiainspection/qima-platform",n="qima-github",i="qima-deploy-available";let a,o;const l=function(){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/labels`,{headers:o}).then((e=>e.json()));console.log(e);const n=e.filter((e=>-1!==e.name.indexOf("deploy-to-"))),a=(yield fetch(`${t}/pulls`,{headers:o}).then((e=>e.json()))).filter((e=>e.labels.some((e=>-1!==e.name.indexOf("deploy-to-"))))),l=n.map((e=>{let t=a.find((t=>t.labels.some((t=>-1!==t.name.indexOf(e.name)))));return`<a id="${e.name}" class="IssueLabel hx_IssueLabel width-fit mb-1 mr-1 ${t?"":i}" ${t?'style="--label-r:188;--label-g:33;--label-b:5;--label-h:9;--label-s:94;--label-l:37;"':'style="--label-r:166;--label-g:252;--label-b:189;--label-h:136;--label-s:93;--label-l:81; cursor: pointer"'}>${e.name.split("deploy-to-")[1]}</a>`})).join("");document.getElementById("qima-sandboxes").innerHTML=l,s()}))},s=function(){var e;null===(e=document.getElementById("qima-sandboxes-refresh-button"))||void 0===e||e.addEventListener("click",(()=>l())),Array.from(document.getElementsByClassName(i)).forEach((e=>{e.addEventListener("click",(()=>{var t;return d(e.id,null!==(t=document.URL.split("/").pop())&&void 0!==t?t:"")}))}))},d=function(n,i){return e(this,void 0,void 0,(function*(){yield fetch(`${t}/issues/${i}/labels`,{method:"POST",headers:o,body:JSON.stringify({labels:[n]})})}))},r=function(){return e(this,void 0,void 0,(function*(){try{!function(){var e;if(!document.getElementById(n)){const t=document.getElementsByClassName("discussion-sidebar-item")[2],i=document.createElement("div");i.id=n,i.className="discussion-sidebar-item",i.innerHTML='<div class="discussion-sidebar-heading text-bold">Sandboxes availability \n    <button class="float-right d-block text-center mr-2 btn-link muted-icon" id="qima-sandboxes-refresh-button">\n        <span class="reviewers-status-icon tooltipped tooltipped-nw" aria-label="Refresh sandboxes status">\n            <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-sync">\n                <path fill-rule="evenodd" d="M8 2.5a5.487 5.487 0 00-4.131 1.869l1.204 1.204A.25.25 0 014.896 6H1.25A.25.25 0 011 5.75V2.104a.25.25 0 01.427-.177l1.38 1.38A7.001 7.001 0 0114.95 7.16a.75.75 0 11-1.49.178A5.501 5.501 0 008 2.5zM1.705 8.005a.75.75 0 01.834.656 5.501 5.501 0 009.592 2.97l-1.204-1.204a.25.25 0 01.177-.427h3.646a.25.25 0 01.25.25v3.646a.25.25 0 01-.427.177l-1.38-1.38A7.001 7.001 0 011.05 8.84a.75.75 0 01.656-.834z"></path>\n            </svg>\n        </span>\n    </button></div><div class="d-flex flex-wrap" id="qima-sandboxes"></div>',null===(e=t.parentNode)||void 0===e||e.insertBefore(i,t.nextSibling)}}(),yield chrome.storage.sync.get("github_token",(e=>{o={Authorization:`Bearer ${e.github_token}`},console.log(o)})),yield l()}catch(e){console.log(e)}}))};r(),new MutationObserver((()=>{-1!==location.href.indexOf("https://github.com/asiainspection/qima-platform/pull/")?a!==location.href&&(a=location.href,setTimeout((()=>r()),2e3)):a=""})).observe(document,{subtree:!0,childList:!0})}})[136]()})();